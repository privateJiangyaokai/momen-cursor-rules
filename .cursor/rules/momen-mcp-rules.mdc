---
description: To obtain Momen.app projects' backend schema via MCP server
alwaysApply: false
---

# Momen MCP Server Overview
Momen MCP is used to interact with the Momen.app editor backend to obtain relevant information about Momen projects, including the user's project list, project database structure, configurations for authentication, actionflows, third-party APIs and AI agents. 

To interact with the MCP server, in the current project directory, check for the existence of `@.momen/momenAccount.json` file. If it already exists, try to use the token inside when calling other momen.app tools to avoid doing unnecessary logins. Also check for the existence of subdirectories of `@.momen/`, each subdirectory's name represents a separate projectExId. Check for the existence of `@.momen/currentProject`, if it does exist, its content reflects the currently active projectExId. 

Make sure that you always know which project you are working with. 
Make sure that you already have a valid token before calling tools. In case you do not have a token:
- First, ask the user for their email and password.
- Call the login method to get the `authToken`.
- Base64 decode the `authToken` to get its expiration time.
- Write the `authToken` and its expiration time to `@.momen/momenAccount.json`.
User may search for projects, and you should use `get_projects`. 
In the end, make sure that the currently active project's schema is properly saved. 

User may choose to refresh the current project's backend schema or switch to a new project. Confirm with the user their intention if necessary. 
Check if the backend schema already exist in `@.momen/{projectExId}/` where `{projectExId}` comes from `@.momen/currentProject`.
- If so, ask the user whether to refresh the schema or switch projects.
  - If the user chooses to switch projects, make sure to get the new schema according to the new project id and save it in the corresponding directory `@.momen/{projectExId}/` and update `@.momen/currentProject`. 
- If not:
  - Call `get_projects` to get the list of recent projects.
  - Let the user select the specific `projectExId` to get.

In order to get the most up-to-date schema, call `get_schema`, passing in the `projectExId`. You should ALWAYS then break up and SAVE the entire schema under `@.momen/{projectExId}`. 
- Save the complete database structure as postgresql DDL in `@.momen/{projectExId}/dbSchema.sql`. Make sure you reflect all the relationships and constraints. 
- Save all third party APIs' definition (verbatim) in `@.momen/{projectExId}/thirdPartyApis.json` 
- Save all actionflows' definition in `@.momen/{projectExId}/actionflows.json`, according to this jsonSchema.
```json
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "array",
  "items": {
    "$ref": "#/definitions/actionFlowObject"
  },
  "definitions": {
    "actionFlowObject": {
      "type": "object",
      "description": "A token-efficient representation of an action flow with exact I/O definitions and a single pseudocode block for the logic summary.",
      "properties": {
        "id": {
          "type": "string",
          "description": "The unique id of the action flow."
        },
        "version": {
          "type": "string",
          "description": "The version of the action flow."
        },
        "name": {
          "type": "string",
          "description": "The unique name of the action flow."
        },
        "inputs": {
          "type": "object",
          "description": "An object defining the exact input parameters for the flow. Keys are parameter names, values are their data types.",
          "patternProperties": {
            "^.*$": {
              "$ref": "#/definitions/parameterType"
            }
          }
        },
        "outputs": {
          "type": "object",
          "description": "An object defining the exact output parameters for the flow. Keys are parameter names, values are their data types.",
          "patternProperties": {
            "^.*$": {
              "$ref": "#/definitions/parameterType"
            }
          }
        },
        "logicSummary": {
          "type": "string",
          "description": "A single block of JavaScript-style pseudocode that describes the entire inner logic of the flow, with no comments."
        }
      },
      "required": [
        "name",
        "inputs",
        "outputs",
        "logicSummary"
      ]
    },
    "parameterType": {
      "type": "string",
      "description": "The data type of an input or output parameter.",
      "enum": [
        "BIGINT",
        "BIGSERIAL",
        "TEXT",
        "JSONB",
        "TIMESTAMPTZ",
        "BOOLEAN",
        "IMAGE",
        "VIDEO",
        "DECIMAL",
        "DATE",
        "GEO_POINT",
        "ANY"
      ]
    }
  }
}
```
- Save all AI agents' definition (verbatim) `@.momen/{projectExId}/aiAgents.json`.
